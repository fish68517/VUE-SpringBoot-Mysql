# 沈阳音乐节管理系统 - 需求规范文档

## 介绍

沈阳音乐节管理系统是一个基于 Spring Boot + Vue3 的综合性音乐节管理平台，面向普通用户和管理员两类角色。系统支持用户注册登录、实名认证、在线购票、周边商品销售、内容发布互动、地理位置打卡积分、以及完整的后台管理功能。该系统的核心特色是融合沈阳本地文化元素（满族文化、本土乐队、地方美食等），通过"打卡盛京"积分任务实现沉浸式地域文化体验。

## 术语表

- **用户**：系统的普通使用者，包括游客和注册用户
- **管理员**：拥有后台管理权限的系统操作者
- **实名认证**：用户提交身份证号进行身份验证，用于防止黄牛和一人多票
- **分区**：音乐节场地的不同区域（A区、B区、站区、VIP区等），每个分区有独立的库存限额
- **电子票**：购票成功后生成的数字凭证，包含二维码和身份证后四位
- **积分**：用户通过打卡任务、购票等行为获得的虚拟货币，可用于兑换周边商品或权益
- **打卡任务**：管理员设置的地理位置相关任务，用户在指定位置上传照片完成打卡获得积分
- **地理围栏**：以经纬度和半径定义的地理范围，用于限制打卡任务的有效位置
- **周边商品**：与音乐节相关的实体或虚拟商品，可通过现金购买或积分兑换
- **订单**：用户购票或购买商品后生成的交易记录

## 需求

### 需求 1：用户注册与登录

**用户故事：** 作为游客，我想通过手机号或账号密码进行注册和登录，以便访问个人中心和购票功能。

#### 验收标准

1. WHEN 用户在注册页面输入手机号和验证码，THE 系统 SHALL 创建新用户账户并跳转到登录页面
2. WHEN 用户在登录页面输入账号和密码，THE 系统 SHALL 验证凭证并返回有效的会话令牌
3. WHEN 用户选择手机号登录方式，THE 系统 SHALL 发送验证码到指定手机号
4. IF 用户输入的验证码与发送的验证码不匹配，THEN THE 系统 SHALL 显示错误提示并拒绝登录
5. WHEN 用户成功登录，THE 系统 SHALL 在本地存储会话令牌并自动跳转到首页

---

### 需求 2：实名认证与个人信息管理

**用户故事：** 作为注册用户，我想完成实名认证并管理个人信息，以便购票和接收订单信息。

#### 验收标准

1. WHEN 用户在个人中心提交身份证号、姓名等实名信息，THE 系统 SHALL 保存认证信息并标记用户为已认证状态
2. WHEN 用户编辑个人信息（头像、昵称、邮箱、收货地址），THE 系统 SHALL 更新用户档案并显示成功提示
3. IF 用户未完成实名认证，THEN THE 系统 SHALL 在购票流程中强制要求完成认证
4. WHEN 用户查看个人信息，THE 系统 SHALL 显示身份证号的脱敏版本（仅显示后四位）
5. WHILE 用户处于已认证状态，THE 系统 SHALL 允许用户进行购票操作

---

### 需求 3：音乐节主页展示

**用户故事：** 作为游客，我想在主页查看音乐节的基本信息、倒计时、演出日程和艺人列表，以便了解音乐节详情。

#### 验收标准

1. WHEN 用户访问音乐节主页，THE 系统 SHALL 显示轮播大图、倒计时、沈阳城市宣传片和音乐节主题介绍
2. WHEN 用户查看演出日程，THE 系统 SHALL 以时间轴形式展示多舞台的演出安排
3. WHEN 用户点击艺人列表中的艺人，THE 系统 SHALL 显示艺人详情页面，并对沈阳本土乐队进行特殊标注
4. WHEN 用户访问主页，THE 系统 SHALL 实时显示音乐节开始前的倒计时（天、小时、分钟、秒）
5. WHERE 用户需要了解交通信息，THE 系统 SHALL 提供交通指南、停车攻略和沈阳地铁/公交推荐

---

### 需求 4：天气与交通信息展示

**用户故事：** 作为用户，我想查看音乐节期间的天气预报和交通建议，以便做好出行准备。

#### 验收标准

1. WHEN 用户访问天气页面，THE 系统 SHALL 调用天气 API 获取音乐节期间的逐日天气预报
2. WHEN 系统显示天气信息，THE 系统 SHALL 包含温度、湿度、风力等详细数据和穿衣建议
3. WHEN 用户查看交通指南，THE 系统 SHALL 显示停车攻略、沈阳地铁和公交推荐路线
4. WHEN 用户查看入场须知，THE 系统 SHALL 显示防疫要求、安检须知等重要信息
5. WHILE 用户浏览信息页面，THE 系统 SHALL 确保所有内容可正常加载且信息准确

---

### 需求 5：分区购票流程

**用户故事：** 作为已认证用户，我想选择分区购票，以便获得音乐节的入场资格。

#### 验收标准

1. WHEN 用户进入购票页面，THE 系统 SHALL 显示可用的场次和分区列表，包括每个分区的剩余票量和价格
2. WHEN 用户选择分区，THE 系统 SHALL 检查该分区是否有可用票量
3. IF 用户选择的分区票量已售罄，THEN THE 系统 SHALL 显示"已售罄"提示并禁止购票
4. WHEN 用户填写购票人实名信息（支持一人代购最多 4 人），THE 系统 SHALL 验证每个购票人的身份证号
5. IF 同一身份证号已购买过该场次的票，THEN THE 系统 SHALL 拒绝购票并显示"该身份证已购票"提示

---

### 需求 6：支付与电子票生成

**用户故事：** 作为购票用户，我想完成支付并获得电子票，以便凭票入场。

#### 验收标准

1. WHEN 用户确认订单信息，THE 系统 SHALL 跳转到模拟支付页面并显示订单总金额
2. WHEN 用户完成支付，THE 系统 SHALL 生成电子票并包含二维码和身份证后四位
3. WHEN 用户查看"我的电子票"，THE 系统 SHALL 显示所有已购票的电子票列表
4. WHEN 用户选择电子票，THE 系统 SHALL 提供下载 PDF 功能，使用 html2canvas 或 pdf-make 生成可下载文件
5. WHILE 电子票处于有效状态，THE 系统 SHALL 确保二维码可被扫描识别

---

### 需求 7：周边商品浏览与购物车

**用户故事：** 作为用户，我想浏览周边商品、加入购物车并结算，以便购买音乐节相关商品。

#### 验收标准

1. WHEN 用户访问周边商城，THE 系统 SHALL 按分类显示所有上架商品，包括 T 恤、卫衣、帽子、徽章等
2. WHEN 用户查看商品详情，THE 系统 SHALL 显示多张商品图片、规格选项（颜色、尺码）、原价和现价
3. WHEN 用户点击"加入购物车"，THE 系统 SHALL 将商品添加到购物车并显示成功提示
4. WHEN 用户查看购物车，THE 系统 SHALL 显示购物车中的所有商品、数量、单价和总价
5. WHEN 用户进行结算，THE 系统 SHALL 要求用户填写收货地址并跳转到支付页面

---

### 需求 8：商品订单管理

**用户故事：** 作为购物用户，我想查看订单状态和物流信息，以便跟踪商品配送。

#### 验收标准

1. WHEN 用户完成支付，THE 系统 SHALL 创建订单并初始状态为"已支付"
2. WHEN 管理员发货，THE 系统 SHALL 更新订单状态为"已发货"并显示物流单号
3. WHEN 用户查看"我的订单"，THE 系统 SHALL 显示所有订单及其当前状态（已支付、已发货、已完成）
4. WHILE 订单处于"已发货"状态，THE 系统 SHALL 允许用户查看物流单号
5. IF 用户要求退单，THEN THE 系统 SHALL 显示"售出概不退换"提示并拒绝退单请求

---

### 需求 9：内容发布与管理

**用户故事：** 作为管理员，我想发布和管理新闻、公告、攻略等内容，以便向用户传达重要信息。

#### 验收标准

1. WHEN 管理员在后台发布新闻公告，THE 系统 SHALL 保存内容并在前端显示
2. WHEN 管理员编辑内容，THE 系统 SHALL 支持富文本编辑和多图上传功能
3. WHEN 管理员管理轮播图，THE 系统 SHALL 支持上传、排序和删除轮播图
4. WHEN 管理员维护艺人信息，THE 系统 SHALL 支持标注沈阳本土乐队并显示艺人详情
5. WHEN 管理员编辑演出日程，THE 系统 SHALL 支持以时间轴形式维护多舞台的演出安排

---

### 需求 10：用户互动功能

**用户故事：** 作为用户，我想对资讯进行点赞、收藏、评论，以便表达观点和互动。

#### 验收标准

1. WHEN 用户点击资讯的点赞按钮，THE 系统 SHALL 记录点赞操作并更新点赞数
2. WHEN 用户点击收藏按钮，THE 系统 SHALL 将资讯添加到用户的收藏列表
3. WHEN 用户提交评论，THE 系统 SHALL 保存评论内容并显示在资讯下方
4. WHEN 用户点击"加入我的关注"，THE 系统 SHALL 将音乐节添加到用户的关注列表
5. WHILE 用户已收藏资讯，THE 系统 SHALL 在收藏按钮上显示已收藏状态

---

### 需求 11：打卡任务与积分系统

**用户故事：** 作为用户，我想在指定位置完成打卡任务并获得积分，以便兑换周边商品。

#### 验收标准

1. WHEN 用户访问打卡任务页面，THE 系统 SHALL 显示所有进行中的打卡任务及其积分奖励
2. WHEN 用户在指定地理位置打开打卡任务，THE 系统 SHALL 验证用户位置是否在地理围栏范围内
3. IF 用户位置不在地理围栏范围内，THEN THE 系统 SHALL 显示"位置不符"提示并禁止打卡
4. WHEN 用户上传打卡照片，THE 系统 SHALL 保存照片并将打卡记录提交审核
5. WHEN 管理员审核通过打卡记录，THE 系统 SHALL 自动为用户增加相应积分

---

### 需求 12：积分商城与兑换

**用户故事：** 作为积分用户，我想用积分兑换周边商品或权益，以便获得限定奖励。

#### 验收标准

1. WHEN 用户访问积分商城，THE 系统 SHALL 显示所有可兑换的商品，包括实体周边和虚拟权益
2. WHEN 用户查看商品详情，THE 系统 SHALL 显示所需积分、库存数量和倒计时
3. IF 用户积分不足，THEN THE 系统 SHALL 显示"积分不足"提示并禁止兑换
4. WHEN 用户提交兑换申请，THE 系统 SHALL 保存申请并等待管理员审核
5. WHEN 管理员审核通过兑换申请，THE 系统 SHALL 扣除用户积分并发放商品或权益

---

### 需求 13：后台仪表盘与数据统计

**用户故事：** 作为管理员，我想查看系统的关键数据指标，以便了解运营情况。

#### 验收标准

1. WHEN 管理员访问仪表盘，THE 系统 SHALL 显示今日、近 7 日、近 30 日的订单量趋势（票务+商品）
2. WHEN 管理员查看用户增长曲线，THE 系统 SHALL 显示用户注册数的时间序列数据
3. WHEN 管理员查看分区售票热力图，THE 系统 SHALL 实时显示各分区的剩余票量和售罄速度
4. WHEN 管理员查看商品销量排行，THE 系统 SHALL 显示销量最高的 10 件商品
5. WHEN 管理员查看打卡任务统计，THE 系统 SHALL 显示各任务的完成次数和通过率

---

### 需求 14：用户管理与权限控制

**用户故事：** 作为管理员，我想管理用户账户和权限，以便维护系统安全和秩序。

#### 验收标准

1. WHEN 管理员访问用户管理页面，THE 系统 SHALL 显示用户列表并支持按条件搜索和导出 Excel
2. WHEN 管理员查看用户详情，THE 系统 SHALL 显示用户的实名信息（身份证号脱敏显示，后四位明文）
3. WHEN 管理员封禁用户，THE 系统 SHALL 禁止该用户登录和进行交易操作
4. WHEN 管理员手动调整用户积分，THE 系统 SHALL 更新积分并记录操作日志
5. WHEN 管理员冻结用户积分，THE 系统 SHALL 禁止该用户使用积分进行兑换

---

### 需求 15：票务管理与库存控制

**用户故事：** 作为管理员，我想管理场次、分区和库存，以便控制票务销售。

#### 验收标准

1. WHEN 管理员创建新场次，THE 系统 SHALL 保存场次信息并设置为可销售状态
2. WHEN 管理员为分区设置库存，THE 系统 SHALL 限制该分区的最大购票人数
3. WHEN 管理员为分区设置价格，THE 系统 SHALL 在购票页面显示该价格
4. WHEN 管理员手动补票或减票，THE 系统 SHALL 更新分区库存并记录操作
5. WHEN 管理员查看票务订单，THE 系统 SHALL 支持按场次、分区、身份证号、下单时间筛选并导出 Excel

---

### 需求 16：商品与库存管理

**用户故事：** 作为管理员，我想管理周边商品和库存，以便控制商品销售。

#### 验收标准

1. WHEN 管理员创建商品分类，THE 系统 SHALL 保存分类信息并在前端显示
2. WHEN 管理员上架商品，THE 系统 SHALL 设置商品信息（多图、标题、规格、原价、现价、库存）
3. WHEN 管理员下架商品，THE 系统 SHALL 将商品从前端隐藏但保留历史数据
4. WHEN 商品库存少于 10 件，THE 系统 SHALL 在管理后台高亮显示库存预警
5. WHEN 管理员修改商品信息，THE 系统 SHALL 更新商品详情并立即在前端生效

---

### 需求 17：打卡任务管理与审核

**用户故事：** 作为管理员，我想创建和管理打卡任务，并审核用户的打卡记录。

#### 验收标准

1. WHEN 管理员创建打卡任务，THE 系统 SHALL 设置任务名称、积分奖励、有效时间段和地理围栏（经纬度+半径）
2. WHEN 管理员上传任务封面图，THE 系统 SHALL 保存图片并在前端显示
3. WHEN 管理员查看打卡记录列表，THE 系统 SHALL 显示所有用户的打卡照片和审核状态
4. WHEN 管理员批量审核打卡记录，THE 系统 SHALL 支持通过或拒绝操作，拒绝需填写原因
5. WHEN 管理员审核通过打卡记录，THE 系统 SHALL 自动为用户增加相应积分

---

### 需求 18：积分商城管理与兑换审核

**用户故事：** 作为管理员，我想管理积分商城商品和审核用户兑换申请。

#### 验收标准

1. WHEN 管理员创建积分商品，THE 系统 SHALL 设置商品类型（实体/虚拟）、所需积分、库存和倒计时
2. WHEN 管理员上架积分商品，THE 系统 SHALL 在前端的积分商城显示该商品
3. WHEN 管理员查看兑换订单，THE 系统 SHALL 显示用户的兑换申请和当前状态
4. WHEN 管理员审核兑换申请，THE 系统 SHALL 支持通过或拒绝，通过时自动扣除用户积分
5. WHEN 管理员为实体商品填写物流单号，THE 系统 SHALL 更新订单状态为"已发货"

---

### 需求 19：积分流水与数据查询

**用户故事：** 作为管理员，我想查询积分流水和用户积分情况，以便监控积分系统。

#### 验收标准

1. WHEN 管理员访问积分流水查询，THE 系统 SHALL 显示所有积分变动记录
2. WHEN 管理员按用户、时间、任务类型筛选，THE 系统 SHALL 返回符合条件的积分流水
3. WHEN 管理员查看用户积分管理，THE 系统 SHALL 显示用户当前积分余额和历史变动
4. WHEN 管理员手动加减用户积分，THE 系统 SHALL 更新积分并记录操作原因
5. WHILE 管理员查询数据，THE 系统 SHALL 确保数据准确性和查询性能

---

### 需求 20：订单导出与报表

**用户故事：** 作为管理员，我想导出订单数据和生成报表，以便进行数据分析。

#### 验收标准

1. WHEN 管理员在订单列表点击导出，THE 系统 SHALL 生成 Excel 文件并下载
2. WHEN 管理员导出票务订单，THE 系统 SHALL 包含场次、分区、购票人、身份证号等信息
3. WHEN 管理员导出商品订单，THE 系统 SHALL 包含商品名称、数量、价格、收货地址等信息
4. WHEN 管理员导出兑换订单，THE 系统 SHALL 包含商品名称、所需积分、用户信息等
5. WHILE 导出过程进行中，THE 系统 SHALL 显示进度提示并在完成后自动下载文件
